<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-145890894-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', 'UA-145890894-1');
    </script>


    <meta charset="utf-8">
    <title>FHSched</title>
    <link rel="shortcut icon" type="image/ico" href="images/icon.ico">
    <link rel="apple-touch-icon" sizes="57x57" href="images/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="144x144" href="images/apple-icon-144x144.png">

    <script type="text/javascript" src="js/FHSched_Schedule_Data_V_1.13.js"> </script>
    <script type="text/javascript" src="js/FHSched_Calendar_Data_V_1.8.js"></script>
    <script type="text/javascript" src="js/FHSched_Base_V_1.9.js"></script>

    <link href="https://fonts.googleapis.com/css?family=Anton" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <link rel="stylesheet" href="css/FHSched_V_1.17.css">
    <link rel="stylesheet" href="css/Home_1.2.css">
    <link rel="stylesheet" href="css/Dark_Mode_1.0.css">
  </head>
  <body onload="createThemes()" id="body" class = "dark">
    <!--
    <img class="logo" src="images/weblogo.png" width="80" height="74">
  -->
    <a id = "ham-a" class = "ham-a" role="button" onclick="showSidebar()"><img src="images/Hamburger_icon.png" class="ham" id = "ham-switch"></a>
    <a class="ng-logo-a" role="button" onclick="showNGBanner()">
      <img src="images/National_Guard_Logo.png" class = "ng-logo">
    </a>

    <div>
      <p class="header">
        <a href="/">FHSched</a>
      </p>
    </div>

    <div class="slider" id="sidebar">
      <a class = "close-sidebar" role="button" onclick="showSidebar()">
        <img src="images/close-icon.png" class="close-icon">
      </a>
      <ul id = "sidebar-list">
        <li><a href="">Home</a></li>
        <li><a href="about/">About</a></li>
        <!--
        <li><a href="../calendar/">Calendar</a></li>

        <li>
          <a role="button" onclick="shuttleBus()" id = "shuttle-bus-toggle">Shuttle Bus Off</a>
        </li>
        -->
        <li id="add-theme">
          <a role="button" onclick="showAddTheme()" id="a-add-theme">+ Theme</a>
          <a role="button" id="input-theme">
            <input type="text" id="modeInput" name="modeInput" placeholder="Eg: Dark"><button id = "inputButton" type=button onclick="addTheme()">Add</button>
          </a>
        </li>
        <li>
          <a role="button" onclick="localStorage.setItem('mode', 'classic'); document.querySelector('body').className = ''; document.querySelector('body').classList.add('classic')">Classic Theme</a>
        </li>
      </ul>
    </div>

    <!--
    <p class="schedule-display">Normal Schedule</p>
    -->

    <div id="periodDiv" class="time-schedule">
      <p id = "period" class = "period-display">No Period</p>
      <p id = "timer" class = "timer">Not School Hours</p>
      <button class = "btn btn-left" onclick = "changePeriod(-1)">
        &#8249;
      </button>
      <button class = "btn btn-right" onclick = "changePeriod(1)">
        &#8250;
      </button>
    </div>
    <p id = "periodCountdown" class = "period-countdown"> Period Countdown: </p>
    <p id = "remainingTime" class = "remaining-time">School begins at 7:35</p>

    <div id = "lunchDiv" class="lunchBtnDiv">
      <button onclick = "changeLunch('a')" class = "lunchBtn">
        A<br> <p>Lunch</p>
      </button>
      <button onclick = "changeLunch('b')" class = "lunchBtn">
        B<br> <p>Lunch</p>
      </button>
      <button onclick = "changeLunch('c')" class = "lunchBtn">
        C<br> <p>Lunch</p>
      </button>
    </div>

    <div class="">
      <p class = "splash">
        Stay updated for the next 2 days!
        <br>
        Each day solve for 2 scrambled letters.
        <br>
        Collect all letters from Tuesday to Friday.
        <br>
        Unscramble for the <a role="button" onclick="showSidebar()" style = "text-decoration:none;">theme</a>, available Friday.
        <br>
        Click to solve Part 3: <a href="puzzle">Puzzle</a>
        <br>
        Keep track of the letters!
      </p>
    </div>

    <div id = "wrongLunchDiv" class="wrongLunchDiv">
      <button onclick = "resetLunch()" class = "wrongLunchBtn">
        Wrong lunch?
      </button>
    </div>

    <p class="bottom-space"></p>
    <footer>
      <div class="foot">
        <ul>
          <li><a href="privacy-policy/">Privacy Policy</a></li>
        </ul>
        <ul>
          <li>2019 CodingForFishers</li>
          <li>Version 1.5.2</li>
        </ul>
        <ul>
          <li>
            <address style="all: unset">
              Contact: <a href="mailto:fhsched2019@gmail.com">fhsched2019@gmail.com</a>
            </address>
          </li>
        </ul>
      </div>
    </footer>

    <div id="national-guard-banner" class="national-guard-banner">
      <div class="container">
        <p>
          Get started here:
          <a href="https://nationalguard.com/get-started" target="_blank">https://nationalguard.com/get-started</a>
          <br>
          Contact: SGT Abigail Bartholomew | (765) 265-2906
          <br>
          <a href="https://www.instagram.com/sgtabbibart/?hl=en" target="_blank">https://www.instagram.com/sgtabbibart/?hl=en</a>
        </p>
        <a class = "close-sidebar" role="button" onclick="showNGBanner()">
          <img src="images/close-icon.png" class="close-icon">
        </a>
      </div>
    </div>

    <!--
    <?php
    if(!isset($_COOKIE["accept-cookies"])) {
    ?>
    <div class="cookie-banner">
      <div class="container">
        <p style="margin-top:5px;">This website uses cookies to improve user experience. By using the website, you consent to the use of cookies and our <a href="privacy-policy">Privacy Policy</a>.</p>
        <a href="?accept-cookies" class="button">Continue</a>
      </div>
    </div>
    <?php
    }
    ?>
    -->

    <script type="text/javascript">
      //Used for cookie banner
      if($('.cookie-banner').length)
      {
        $('.cookie-banner').slideDown(800);
      }
    </script>

    <script type="text/javascript">     //Not FHSSched
    var isHomePage = '';

    var inputEl = document.querySelector("#modeInput");
    var inputButton = document.querySelector("#inputButton");

    inputEl.addEventListener("keyup", function(event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        // Trigger the button element with a click
        document.getElementById("inputButton").click();
      }
    });

    //Referencing HTML elements
    var timer = document.querySelector("#timer");
    var period = document.querySelector("#period");
    var remainingTime = document.querySelector("#remainingTime");
    var periodCountdown = document.querySelector("#periodCountdown");
    var periodDiv = document.querySelector("#periodDiv");
    var lunchDiv = document.querySelector("#lunchDiv");
    var wrongLunchDiv = document.querySelector("#wrongLunchDiv");

    //Gets current time
    var today = new Date();
    var curMonth = today.getMonth();
    var curDate = today.getDate();
    var curHour = today.getHours();
    var curMin = today.getMinutes();
    var curSec = today.getSeconds();

    function updateClock()
    {
      today = new Date();
      curMonth = today.getMonth();
      curDate = today.getDate();
      curHour = today.getHours();
      curMin = today.getMinutes();
      curSec = (59 - today.getSeconds());
      curScheduleValue = calendar[curMonth][curDate - 1];
      curTotalMin = (curHour * 60) + curMin;
      currentSchedule = JSON_schedule[0][curScheduleValue];
      if(curPeriodKey == "lunch")
      {
        displayTimeLeft((currentSchedule[curPeriodKey][curMultiKey].EHours * 60) + currentSchedule[curPeriodKey][curMultiKey].EMin - curTotalMin - 1);
      }
      else if(takeShuttleBus && periodKey == "periodSeven")
      {
        displayTimeLeft((currentSchedule[curPeriodKey][shuttleKey].EHours * 60) + currentSchedule[curPeriodKey][shuttleKey].EMin - curTotalMin - 1);
      }
      else if(curPeriodKey != null)
      {
        displayTimeLeft((currentSchedule[curPeriodKey].EHours * 60) + currentSchedule[curPeriodKey].EMin - curTotalMin - 1);
      }
      else
      {
        displayTimeLeft(-1);
      }
    }

    var curTotalMin = (curHour * 60) + curMin; //Number used to compare other times

    var periodDisplayKey = null;
    var curPeriodKey = null;
    var curMultiKey = null;
    var shuttleKey = null;
    var takeShuttleBus = false; //JSON.parse(localStorage.getItem('shuttleBus'));

    var curScheduleValue = calendar[curMonth][curDate - 1];

    //The schedule is loaded from a JSON object
    var JSON_schedule = data;
    //console.log(JSON_schedule)

    var currentSchedule = JSON_schedule[0][curScheduleValue];
    var currentPassingPeriod = null;

    //Creates gallery dots
    var galleryDots = [];

    for (var i = 0; i < Object.keys(currentSchedule).length / 2; i++)
    {
      galleryDots[i] = document.createElement("button");
      galleryDots[i].setAttribute("class", "dot");
      galleryDots[i].setAttribute("onclick", "skipToPeriod(" + i + ")");
      periodDiv.appendChild(galleryDots[i]);
    }

    //Function that compared the current schedule and check for the period
    function checkCurPeriod()
    {
      var periodTotalMinStart;
      var periodTotalMinEnd;

      periodKey = checkTimeFrame(currentSchedule);
      if(periodKey == null)
      {
        curPeriodKey = null;
        return;
      }

      if(takeShuttleBus)
      {
        shuttleKey = "shuttleBus";
      }

      if(periodKey == "lunch")
      {
        curMultiKey = checkTimeFrame(currentSchedule["lunch"]);
      }

      periodDisplayKey = periodKey;
      curPeriodKey = periodKey;
      if (Object.keys(currentSchedule).indexOf(periodKey) % 2 == 0)
      {
        currentPassingPeriod = periodKey;
      }
      displayPeriod();
    }

    //Finds what time frame the user is in
    function checkTimeFrame(framesTime)
    {
      for (var timeFrame in framesTime)
      {
        //Setting Variables to compare against current time
        totalMinStart = (framesTime[timeFrame].SHours * 60) + framesTime[timeFrame].SMin;
        totalMinEnd = (framesTime[timeFrame].EHours * 60) + framesTime[timeFrame].EMin - 1;

        //If the current time is in-between the start and end of the period
        if (curTotalMin >= totalMinStart && curTotalMin <= totalMinEnd)
        {
          return timeFrame;
        }
      }
      return null;
    }

    function changeLunch(lunchType)
    {
      setLunchCookie("lunchPeriod", lunchType);
      editLunchPeriod(currentSchedule["lunch"]);
    }

    function resetLunch()
    {
      setLunchCookie("lunchPeriod", "");
      document.location.reload();
    }

    //Edits the lunch period times to adjust for lunch
    function editLunchPeriod(lunchObject)
    {
      var lunchType = getCookie("lunchPeriod");
      if (lunchType == "a" || lunchType == "b" || lunchType == "c")
      {
        lunchDiv.setAttribute("style", "display:none");
        wrongLunchDiv.setAttribute("style", "display:block");
      }
      else {
        lunchDiv.setAttribute("style", "display:block");
        wrongLunchDiv.setAttribute("style", "display:none");
      }
      /*
      if(localStorage.getItem('shuttleBus') == "false")
      {
        document.querySelector("#shuttle-bus-toggle").textContent = "Shuttle Bus Off";
      }
      else
      {
        document.querySelector("#shuttle-bus-toggle").textContent = "Shuttle Bus On";
      }
      */
      switch (lunchType)
      {
        case "a":
          lunchObject["firstPeriodFour"] = combinePeriods(lunchObject, "bLunch", "cLunch");
          delete lunchObject["passingBLunch"];
          break;
        case "b":
          replaceObject(lunchObject, "aLunch", "firstPeriodFour");
          replaceObject(lunchObject, "cLunch", "secondPeriodFour");
          break;
        case "c":
          lunchObject["firstPeriodFour"] = combinePeriods(lunchObject, "aLunch", "bLunch");
          delete lunchObject["passingALunch"];
          break;
      }
      checkCurPeriod();
      updateClock();
    }

    function combinePeriods(combineObject, firstPeriod, secondPeriod)
    {
      tempObj = {"SHours": 0, "SMin": 0, "EHours": 0, "EMin": 0};
      tempObj["SHours"] = combineObject[firstPeriod]["SHours"];
      tempObj["SMin"] = combineObject[firstPeriod]["SMin"];
      tempObj["EHours"] = combineObject[secondPeriod]["EHours"];
      tempObj["EMin"] = combineObject[secondPeriod]["EMin"];
      delete combineObject[firstPeriod];
      delete combineObject[secondPeriod];
      return(tempObj);
    }

    //Displays the time left in the period
    function displayTimeLeft(minsLeft)
    {
      if (curPeriodKey == null)
      {
        remainingTime.textContent = "School begins at 7:35";
        periodCountdown.textContent = "";
      }
      else if (minsLeft < 0)
      {
        checkCurPeriod();
      }
      else
      {
        var hours = Math.floor(minsLeft / 60);
        var minutes = minsLeft % 60;
        var seconds = curSec;
        hours = hours == 0 ? "" : hours == 1 ? "1 hour " : hours + " hours ";
        minutes = minutes == 0 && hours == "" ? "" : minutes == 1 ? "1 minute " : minutes + " minutes ";
        seconds = seconds == 1 ? "1 second" : seconds + " seconds";
        if (remainingTime.textContent != hours + minutes + seconds)
        {
          remainingTime.textContent = hours + minutes + seconds;
        }
        periodCountdown.textContent = "Period Countdown:";
      }
      requestAnimationFrame(updateClock);
    }

    //Displays the input time on the timer element
    function displayPeriod()
    {
      if(curPeriodKey == "lunch" && periodDisplayKey == "lunch")
      {
        var periodDisplay = currentSchedule[periodDisplayKey][curMultiKey];
        periodDisplayName = curMultiKey;
      }
      else if(takeShuttleBus && periodDisplayKey == "periodSeven")
      {
        var periodDisplay = currentSchedule[periodDisplayKey][shuttleKey];
        periodDisplayName = shuttleKey;
      }
      else
      {
        var periodDisplay = currentSchedule[periodDisplayKey];
        periodDisplayName = periodDisplayKey;
      }
      var periodStart = adjustTime(periodDisplay["SHours"], true) + ":" + adjustTime(periodDisplay["SMin"], false);
      var periodEnd = adjustTime(periodDisplay["EHours"], true) + ":" + adjustTime(periodDisplay["EMin"], false);
      timer.textContent = periodStart + " - " + periodEnd;
      updateGallery((Object.keys(currentSchedule).indexOf(periodDisplayKey) - 1) / 2)

      //Displays the period heading by checking key
      switch (periodDisplayName)
      {
        case "passingPeriodZero":
          period.textContent = "Passing Period"
          break;
        case "periodOne":
          period.textContent = "Period 1"
          break;
        case "passingPeriodOne":
          period.textContent = "Passing Period"
          break;
        case "periodOneExam":
          period.textContent = "Period 1 Exam"
          break;
        case "periodTwo":
          period.textContent = "Period 2"
          break;
        case "passingPeriodTwo":
          period.textContent = "Passing Period"
          break;
        case "periodTwoExam":
          period.textContent = "Period 2 Exam"
          break;
        case "periodThree":
          period.textContent = "Period 3"
          break;
        case "passingPeriodThree":
          period.textContent = "Passing Period"
          break;
        case "periodThreeExam":
          period.textContent = "Period 3 Exam"
          break;
        case "periodSmart":
          period.textContent = "SMaRT Period"
          break;
        case "firstPeriodFour":
          period.textContent = "Period 4"
          break;
        case "secondPeriodFour":
          period.textContent = "Period 4"
          break;
        case "passingPeriodFour":
          period.textContent = "Passing Period"
          break;
        case "aLunch":
          period.textContent = "A Lunch"
          break;
        case "passingALunch":
          period.textContent = "Passing Period"
          break;
        case "bLunch":
          period.textContent = "B Lunch"
          break;
        case "passingBLunch":
          period.textContent = "Passing Period"
          break;
        case "cLunch":
          period.textContent = "C Lunch"
          break;
        case "passingCLunch":
          period.textContent = "Passing Period"
          break;
        case "periodFourExam":
          period.textContent = "Period 4 Exam"
          break;
        case "periodFive":
          period.textContent = "Period 5"
          break;
        case "passingPeriodFive":
          period.textContent = "Passing Period"
          break;
        case "periodFiveExam":
          period.textContent = "Period 5 Exam"
          break;
        case "periodSix":
          period.textContent = "Period 6"
          break;
        case "passingPeriodSix":
          period.textContent = "Passing Period"
          break;
        case "periodSixExam":
          period.textContent = "Period 6 Exam"
          break;
        case "periodSeven":
          period.textContent = "Period 7"
          break;
        case "passingPeriodSeven":
          period.textContent = "Passing Period"
          break;
        case "shuttleBus":
          period.textContent = "Period 7 (Shuttle Bus)"
          break;
        case "afterShuttle":
          period.textContent = "Period 7 (After Shuttle)"
          break;
        case "periodSevenExam":
          period.textContent = "Period 7 Exam"
          break;
        case "PLC":
          period.textContent = "PLC"
          break;
        case "periodLunch":
          period.textContent = "Closed for Lunch"
          break;
        case "noSchoolPeriod":
          period.textContent = "No School"
          break;
        case "freshman":
          period.textContent = "Freshman Registration"
          break;
        case "freshmanAndSenior":
          period.textContent = "Freshman and Senior Registration"
          break;
        case "senior":
          period.textContent = "Senior Registration"
          break;
        case "sophomore":
          period.textContent = "Sophomore Registration"
          break;
        case "sophomoreAndJunior":
          period.textContent = "Sophomore and Junior Registration"
          break;
        case "junior":
          period.textContent = "Junior Registration"
          break;
        case "lateRegistration":
          period.textContent = "Late Registration"
          break;
        case "autonomousPeriod":
          period.textContent = "Autonomous Festival"
          break;
        case "techDemoPeriod":
          period.textContent = "Demos"
          break;
        case "pepSession":
          period.textContent = "Pep Session"
          break;
        case "lunch":
          period.textContent = "Period 4 / Lunch"
          break;
        default:
          period.textContent = "No Period"
      }
    }

    //Fixes military time and adds a 0 to a single digit number
    function adjustTime(timeValue, isHour)
    {
      var finalTimeValue = timeValue;
      if (finalTimeValue > 12 && isHour)
      {
        finalTimeValue += -12;
      }
      if (finalTimeValue < 10)
      {
        finalTimeValue = "0" + finalTimeValue;
      }
      return finalTimeValue;
    }

    //Updates the gallery dots by changing the styles
    function updateGallery(curDot)
    {
      for (var i = 0; i < galleryDots.length; i++)
      {
        galleryDots[i].setAttribute("class", "dot");
      }
      if (curDot % 1 == 0)
        galleryDots[curDot].setAttribute("class", "dot dot-cur");
    }

    //Skips to a certain period dictated by the gallery dots
    function skipToPeriod(skipKey)
    {
      periodDisplayKey = Object.keys(currentSchedule)[skipKey*2+1];
      displayPeriod();
    }

    //Changes to the next/previous period with a direction parameter
    function changePeriod(direction)
    {
      var adjustedDir = direction;
      if (periodDisplayKey == null)
      {
        adjustedDir = 1;
      }
      if (currentPassingPeriod == null || periodDisplayKey != currentPassingPeriod)
      {
        periodDisplayKey = next(currentSchedule, periodDisplayKey, adjustedDir);
      }
      periodDisplayKey = next(currentSchedule, periodDisplayKey, adjustedDir);
      displayPeriod();
    }

    function next(object, key, direction)
    {
      var keys = Object.keys(object);
      var i = keys.indexOf(key);
      if (i + direction == -1 || i + direction > Object.keys(object).length - 1)
      {
        //If the key is the beginning or end, loops back
        return keys[i - (direction * (Object.keys(object).length - 1))];
      }
      else
      {
        return keys[i + direction]; //Returns the next/previous key
      }
    }

    function replaceObject(mainObj, ogObj, rpObj)
    {
      mainObj["tempObj"] = mainObj[ogObj];
      delete mainObj[ogObj];
      mainObj[rpObj] = mainObj["tempObj"];
      delete mainObj["tempObj"];
    }

    function setLunchCookie(cname, cvalue) {
      document.cookie = cname + "=" + cvalue + "; expires=Wed, 1 Jan 2020 12:00:00 UTC; path=/";
    }

    function getCookie(cname) {
      var name = cname + "=";
      var decodedCookie = decodeURIComponent(document.cookie);
      var ca = decodedCookie.split(';');
      for(var i = 0; i <ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
          c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
          return c.substring(name.length, c.length);
        }
      }
      return "";
    }

    editLunchPeriod(currentSchedule["lunch"]);

    </script>
  </body>
</html>
